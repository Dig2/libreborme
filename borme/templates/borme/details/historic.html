{% load staticfiles %}
{% comment %}
- csv
{% endcomment %}

<div class="tab-view-details">
        <div class="row">
            <div class="col">
                <ul class="list-inline list-unstyled ul-resum">
                    <li class="list-inline-item">
                        <p class="font-weight-bold mb-0">Última actualización: <span class="font-weight-normal">{{ company.date_updated }}</span></p>
                        <p class="font-weight-bold">Fuente de los datos: <span class="font-weight-normal">Agencia Estatal Boletín Oficial del Estado.</span></p>
                    </li>
                </ul>
            </div>
        </div>

        <div class="container">
            <div class="row mb-3 align-items-center">
                <div class="offset-lg-2">
                    <img src="{% static 'banners/banner1.png' %}">
                    {# <img src="holder.js/720x90"> #}
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <img src="{% static 'assets/img/table/icon1.svg' %}" alt="">Información de la compañía
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-company-information">
                                <thead>
                                </thead>
                                <tbody>
                                <tr>
                                    <th scope="row">NIF</th>
                                    <td>{{ company.nif|default:"Desconocido" }}</td>
                                </tr>
                                <tr>
                                    <th scope="row">Situación Mercantil</th>
                                    <td>{{ company.get_status_display }}</td>
                                </tr>
                                <tr>
                                    <th scope="row">Fecha de constitución</th>
                                    <td>X años ({{ company.date_creation|date|default:"Desconocido" }})</td>
                                </tr>
                                <tr>
                                    <th scope="row">Domicilio</th>
                                    <td>{{ company.domicilio | title |default:"Desconocido" }}</td>
                                </tr>
                                <tr>
                                    <th scope="row">Objeto social </th>
                                    <td>{{ company.objeto|default:"Desconocido" }}</td>
                                </tr>
                                <tr>
                                    <th scope="row">Capital</th>
                                    <td>{% if company.capital %}{{ company.capital }} Euros{% else %}Desconocido{% endif %}</td>
                                </tr>
                                {% if company.liquidators %}
                                <tr>
                                    <th scope="row">Liquidador{{ company.liquidators|length|pluralize:"es" }}</th>
                                    <td>{% for liquidator in company.liquidators %} {{ liquidator.name | title }}{% if not forloop.last %}, {% endif %} {% endfor %}</td>
                                </tr>
                                {% endif %}
                                {% if company.last_auditor %}
                                <tr>
                                    <th scope="row">Auditor</th>
                                    <td>{{ company.last_auditor.name | title}}</td>
                                </tr>
                                {% endif %}
                                {% if company.reason_dissolution %}
                                <tr>
                                    <th scope="row">Motivo de la disolución</th>
                                    <td>{{ company.reason_dissolution }}</td>
                                </tr>
                                {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row  mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <img src="{% static 'assets/img/table/icon2.svg' %}" alt="">Cargos Directivos
                    </div>
                    {% if company.get_cargos_actuales.0 %}
                    <div class="card-body">
                        <a href="{% url 'borme-empresa-csv-actual' company.name|slug2 %}" rel="nofollow" title="Descargar CSV de cargos actuales"><i class="glyphicon glyphicon-download-alt"></i> csv</a>
                        <div class="table-responsive">
                            <table class="table table-striped table-executive-positions">
                                <thead>
                                <tr>
                                    <th scope="col">Cargo</th>
                                    <th scope="col">Persona física/jurídica</th>
                                    <th scope="col">Desde</th>
                                    <th scope="col">Hasta</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for cargo in company.get_cargos_actuales.0 %}

                                {% url 'borme-fecha' cargo.date_from as url_from %}
                                {% url 'borme-fecha' cargo.date_to as url_to %}
                                <tr>
                                    <td>{{ cargo.title }}</td>
                                    <td>{{ cargo | link_to_entity | safe }}</td>
                                    <td><a href="{% url 'borme-fecha' cargo.date_from %}">{{ cargo.date_from }}</a></td>

                                    {% if url_to %}
                                        <td><a href="{{ url_to }}">{{ cargo.date_to }}</a></td>
                                    {% else %}
                                        <td>Actualidad</td>
                                    {% endif %}
                                </tr>
                                {% endfor %}
                                {% if company.get_cargos_actuales.1 %}
                                <tr id="vermascargos_actuales">
                                    <td class="text-center" colspan=4>
                                        <a href="#" onclick="javascript:moreData('{% url 'borme-ajax-empresa' company.slug %}?t=actuales','vermascargos_actuales','tabla_cargos_actuales');return false;" rel="nofollow">Ver más</a>
                                    </td>
                                </tr>
                                {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {% else %}
                        {% if company.is_active %}
                        <i>No hay datos</i> <a href="#" data-toggle="modal" data-target="#myModal">[?]</a>
                        {% else %}
                        <i>La sociedad está inactiva.</i>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>

        {% if company.get_cargos_historial.0 %}
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="bd-example">
                    <details>
                        <summary>Mostrar cargos no vigentes</summary>
                        <div class="card mt-4">
                            <div class="card-header">
                                <img src="{% static 'assets/img/table/icon2.svg' %}" alt="">Cargos Directivos
                            </div>
                            <div class="card-body">
                                <a href="{% url 'borme-empresa-csv-historial' company.slug %}" rel="nofollow" title="Descargar CSV de historial de cargos"><i class="glyphicon glyphicon-download-alt"></i> csv</a>
                                <div class="table-responsive">
                                    <table class="table table-striped table-executive-positions">
                                        <thead>
                                        <tr>
                                            <th scope="col">Cargo</th>
                                            <th scope="col">Persona física/jurídica</th>
                                            <th scope="col">Desde</th>
                                            <th scope="col">Hasta</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for cargo in company.get_cargos_historial.0 %}

                                        {% url 'borme-fecha' cargo.date_from as url_from %}
                                        {% url 'borme-fecha' cargo.date_to as url_to %}
                                        <tr>
                                            <td>{{ cargo.title }}</td>
                                            {% if cargo.type == 'person' %}
                                            <td class="color-red-dark"><a href="{% url 'borme-persona' cargo.name|slug %}">{{ cargo.name|title }}</a></td>
                                            {% else %}
                                            <td class="color-red-dark"><a href="{% url 'borme-empresa' cargo.name|slug2 %}">{{ cargo.name }}</a></td>
                                            {% endif %}

                                            {% if url_from %}
                                            <td class="color-red-dark"><a href="{{ url_from }}">{{ cargo.date_from }}</a></td>
                                            {% else %}
                                            <td>Desconocido</td>
                                            {% endif %}

                                            <td><a href="{% url 'borme-fecha' cargo.date_to %}">{{ cargo.date_to }}</a></td>
                                        </tr>
                                        {% endfor %}

                                        {% if company.get_cargos_actuales.1 %}
                                            <tr id="vermascargos_historial">
                                                <td class="text-center" colspan=4>
                                                    <a href="#" onclick="javascript:moreData('{% url 'borme-ajax-empresa' company.slug %}?t=historial','vermascargos_historial','tabla_cargos_historial');return false;" rel="nofollow">Ver más</a>
                                                </td>
                                            </tr>
                                        {% endif %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </details>
                </div>
            </div>
        </div>
        {% endif %}

    </div>
